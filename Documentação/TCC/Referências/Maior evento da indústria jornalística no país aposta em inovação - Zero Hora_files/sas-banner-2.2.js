var sas=sas||{};sas.banner=sas.banner||{};sas.creativeType={REDIRECT:0,IMAGE:1,FLASH:2,FLV:3,HTML5:4};(function(){var k={};sas.events.addEvent(window,"message",function(q){if(!q.data||!k[q.data]){return}q.source.postMessage(k[q.data].clickUrl,"*")});var e=function(r,s){var q=document.createElement("a");q.href=r;q.target=s;return q};var j=function(t,s,q){var r=document.createElement("iframe");r.id=t;r.scrolling="no";r.frameBorder=0;r.width=s;r.height=q;r.style.margin=0;r.style.padding=0;r.style.width=s+"px";r.style.height=q+"px";return r};var l=function(u,v){if(!v){return}else{var w=document.createElement("div");w.innerHTML="_"+v;var r=1;while(r<w.childNodes.length){var x=w.childNodes[r];if(x.tagName=="SCRIPT"){var q=document.createElement("script");q.type="text/javascript";q.defer="defer";if(!x.src){q.text=x.text}else{q.src=x.src}x=q;r++}u.appendChild(x)}}};var o=function(q){var r=q.instanceIndex>1?"_"+q.instanceIndex:"";return q.tagId||("sas_"+q.formatId+r)};var n=function(u,r,v){var q=r.creatives[0];var s=q.url+(q.url.indexOf("?")<0?"?":"&")+"sasfid="+r.formatId;var t=j("sas_"+r.id+"_iframe",q.width,q.height);t.src=s;sas.events.addLoadEvent(t,function(){v(t)});u.appendChild(t);l(u,q.creativeScript+r.customScript)};var p=function(u,r,w,s){var q=r.creatives[0];if(!s.async){document.write(q.creativeScript+r.customScript)}else{var t=j("sas_"+r.id+"_iframe",q.width,q.height);sas.events.addLoadEvent(t,function(){w(t)});u.appendChild(t);var v=t.contentDocument||t.contentWindow.document;v.write('<body style="margin:0;padding:0"><script type="text/javascript">var inDapIF=inDapMgrIf=true;<\/script>'+q.creativeScript+r.customScript+"</body>");var x=sas.utils.getIEVersion();if(!x||x>9){v.close()}}};sas.utils=sas.utils||{};sas.utils.getIEVersion=function(){var q=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);return q?parseInt(q[1]):undefined};var b=function(r,u){var t=document.createElement("img");var q=t;var v=parseInt(r.pixelRatio)||1;sas.events.addLoadEvent(t,function(){u(t)});t.id=r.id;t.src=r.url;t.alt=r.altText;t.width=r.width/v;t.height=r.height/v;t.border=0;if(!!r.clickUrl){var s=document.createElement("a");s.href=r.clickUrl;s.target=r.clickTarget;s.appendChild(t);q=s}return q};var i=[];var g=function(q){if(q!=null){i.push(q)}};sas.events.addLoadEvent(document,function(){_loaded=true;i.push=function(r){r()};for(var q=0;q<i.length;q++){i[q]()}});var d=function(r,w){var v;var t={id:r.id+"Object",height:r.height,width:r.width};var x={quality:"high",allowScriptAccess:"always",wmode:r.wMode||"window",swLiveConnect:true,flashVars:r.flashVars||""};if(sas.utils.getIEVersion()<11){v=(function(){var y=document.createElement("div");y.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' type='application/x-shockwave-flash'><param name='movie' value='"+r.url+"'><param name='wmode' value='"+x.wmode+"'><param name='flashVars' value='"+x.flashVars+"'></object>";return y.firstChild})();delete x.wmode;delete x.flashVars;sas.events.addLoadEvent(v,function(){w(v)})}else{v=document.createElement("object");t.type="application/x-shockwave-flash";t.data=r.url;g(function(){w(v)})}for(var q in t){v[q]=t[q]}for(var u in x){if(x[u]){var s=document.createElement("param");s.name=u;s.value=x[u];v.appendChild(s)}}return v};var h=function(t,s,u){var r=s.creatives[0];var q=b(r,u);t.appendChild(q);l(t,r.creativeScript+s.customScript)};var m=function(t,s,v){var r=s.creatives[0];var u=(r.version&&r.version<=sas.Browser.Flash.version);if(!u&&(!r.backupImage||!r.backupImage.url)){return}var q=u?d(r,v):b(r.backupImage,v);t.appendChild(q);l(t,r.creativeScript+s.customScript)};var a={};a[sas.creativeType.REDIRECT]=p;a[sas.creativeType.IMAGE]=h;a[sas.creativeType.FLASH]=m;a[sas.creativeType.HTML5]=n;var f=function(q){var r=parseInt(Math.random()*100000000);var s=q.oba==2?"top-left":"top-right";sas.utils.loadLinkCdn("diff/templates/js/adplayer/adplayer.css");sas.utils.loadScriptCdn(["diff/templates/js/adplayer/adplayer.js","diff/templates/js/adplayer/adplayer.sas.js"],{onLoad:function(){$ADP.sas.addOba(q.formatId,false,s,r,q.formatId,r)}})};var c=function(t,r,s){var v=new sas.utils.Latch(["creaLoaded","viewabilityLoaded"]);v.addListener(function(w){sas.viewability.register(w,function(){new Image().src=r.viewability.viewUrl},{duration:r.viewability.duration,area:r.viewability.area,onError:function(){new Image().src=r.viewability.errorUrl}})});var q=r.creatives[0];var u=a[q.type](t,r,function(w){v.notify("creaLoaded",w)},s);if(q.countUrl){new Image().src=q.countUrl}if(r.viewability&&r.viewability.enabled){sas.utils.loadScriptCdn("diff/templates/js/sas/sas-viewability.js",{onLoad:function(){v.notify("viewabilityLoaded")}})}if(r.oba){f(r)}};sas.banner.render=function(r,s){s=s||{};s.async=s.async==null?true:s.async;if(!r.creatives||!r.creatives.length){throw new Error("No creative found for config "+r.id)}var q=r.creatives[0];r.tagId=o(r);k[r.formatId]=q;var u=document.getElementById(r.tagId);if(!u){throw new Error("No element with id "+r.tagId+" found")}if(q&&!a[q.type]){throw new Error("Unsupported banner type "+q.type)}if(r.forcedIframeWidth>0&&r.forcedIframeHeight>0){var t=j("sas_i"+r.tagId,r.forcedIframeWidth,r.forcedIframeHeight);sas.events.addLoadEvent(t,function(){var v=t.contentDocument||t.contentWindow.document;v.body.style.margin=0;v.body.style.padding=0;c(v.body,r,s)});u.appendChild(t)}else{c(u,r,s)}}})();
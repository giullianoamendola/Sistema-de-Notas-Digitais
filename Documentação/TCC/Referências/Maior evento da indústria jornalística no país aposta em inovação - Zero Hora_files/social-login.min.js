!function(e){"use strict";var o=function(e){var o=[];for(var t in e)e.hasOwnProperty(t)&&o.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return o.join("&")},t={getItem:function(e){return e?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},setItem:function(e,o,t,a,s,n){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var i="";if(t)switch(t.constructor){case Number:i=t===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+t;break;case String:i="; expires="+t;break;case Date:i="; expires="+t.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+i+(s?"; domain="+s:"")+(a?"; path="+a:"")+(n?"; secure":""),!0},removeItem:function(e,o,t){return this.hasItem(e)?(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(t?"; domain="+t:"")+(o?"; path="+o:""),!0):!1},hasItem:function(e){return e?new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie):!1},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),o=e.length,t=0;o>t;t++)e[t]=decodeURIComponent(e[t]);return e}},a=function(e,t,a,s,n){var i=new XMLHttpRequest,c=a?o(a):"";"POST"===e&&(i.open(e,t),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.send(c)),"GET"===e&&(i.open(e,t+"?"+c),i.send()),"DELETE"===e&&(i.open(e,t+"?"+c),i.send()),i.onload=function(){if(i.status>=200&&i.status<400){var e=JSON.parse(i.responseText);s&&s(e)}else{var o=JSON.parse(i.responseText);n&&n(i.status,i.statusText,o.status)}},i.ontimeout=function(){n&&n({error:!0,type:"timeout",message:"Request fail, timeout."})}},s=function(o){var t=this;this.settings=o,this.socialNames={facebook:"facebook",twitter:"twitter",google:"google"},this.cookieName="wrs",this.cookieSocialName="socialLogged",this.urlSocialUser="http://www.clicrbs.com.br/wrs/api/socialmediauser",this.socialList=o.socialList,this.socialChecked=[],this.socialNetwork={facebook:{logged:!1,data:{}},twitter:{logged:!1,data:{}},google:{logged:!1,data:{}}};var a=document.createElement("script");e.jQuery||(a.type="text/javascript",a.src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js",document.getElementsByTagName("head")[0].appendChild(a)),e.jQuery?t.addSocialLibs():a.onload=function(){t.addSocialLibs()},this.addBtnsEvents=function(o){var t=this;if(!e.jQuery)return setTimeout(function(){t.addBtnsEvents(o)},500),!1;Object.keys(o).length>0&&Object.keys(o).map(function(e){-1===t.socialList.indexOf(e)&&t.socialList.push(e)});for(var a=0;a<this.socialList.length;a++){var s=this.socialList[a];$("body").on("click",o[s],function(){t[s+"Login"](!0)})}}};s.prototype.checkLogin=function(e,o){var a=this,s=JSON.parse(t.getItem(this.cookieSocialName));if(-1!==this.socialList.indexOf(this.socialNames.facebook)&&-1===this.socialChecked.indexOf(this.socialNames.facebook))if(a.socialChecked.push(a.socialNames.facebook),e&&e.token&&s&&s.name===this.socialNames.facebook){var n={socialLogged:this.socialNames.facebook,wrs:e.token};o&&o(n)}else e&&e.token?o&&o({wrs:e.token}):o&&o({})},s.prototype.facebookLogin=function(e){var o=this,s=new Date;s.setMonth(s.getMonth()+1),s.setDate(1),s.setHours(0),s.setMinutes(0),s.setSeconds(0),e?FB.login(function(e){if("connected"===e.status)if(e.authResponse&&-1!==e.authResponse.grantedScopes.indexOf("email")){var n={name:o.socialNames.facebook,data:e};t.setItem(o.cookieSocialName,JSON.stringify(n),s,"/"),t.setItem(o.cookieSocialName,JSON.stringify(n),s,"/",".clicrbs.com.br"),o.facebookGetInfo(e,function(e){var o=new CustomEvent("paywall.social.success.login",{detail:{error:!1,login:!0,data:JSON.stringify(e.user)}});document.dispatchEvent(o)})}else a("DELETE","https://graph.facebook.com/"+e.authResponse.userID+"/permissions",{access_token:e.authResponse.accessToken},function(o){var t=new CustomEvent("paywall.social.fail.email",{detail:{error:!0,email:!1,data:JSON.stringify(e.authResponse)}});document.dispatchEvent(t)},function(e){console.log(e)});else{var i=new CustomEvent("paywall.social.fail.login",{detail:{error:!0,login:!1}});document.dispatchEvent(i)}},{scope:"email",return_scopes:!0}):FB.getLoginStatus(function(e){"connected"===e.status&&o.facebookGetInfo(e,function(e){var o=new CustomEvent("paywall.social.success.login",{detail:{error:!1,login:!0,data:JSON.stringify(e.user)}});document.dispatchEvent(o)})})},s.prototype.facebookGetInfo=function(e,o){var s=this;this.socialNetwork.facebook.logged=!0,this.socialNetwork.facebook.data.accessToken=e.authResponse.accessToken,this.socialNetwork.facebook.data.signedRequest=e.authResponse.signedRequest,this.socialNetwork.facebook.data.expiresIn=e.authResponse.expiresIn,this.socialNetwork.facebook.data.userID=e.authResponse.userID,a("GET","https://graph.facebook.com/"+s.socialNetwork.facebook.data.userID,{access_token:e.authResponse.accessToken,fields:"name,age_range,email,gender,first_name,middle_name,last_name,locale"},function(e){e&&!e.error&&($.extend(s.socialNetwork.facebook.data,e),e.email&&s.sendInfo({type:"facebook",data:s.socialNetwork.facebook.data},o))},function(e){t.removeItem(s.cookieSocialName,"/"),t.removeItem(s.cookieSocialName,"/",".clicrbs.com.br");var a=new CustomEvent("paywall.social.error.login",{detail:{error:!0,login:!1}});document.dispatchEvent(a),o&&o({})})},s.prototype.sendInfo=function(e,o){var s=this,n={};"facebook"===e.type&&(n.age_range=0,n.link=e.data.userID,n.name=e.data.name,n.locale=e.data.locale,n.last_name=e.data.last_name,n.gender=e.data.gender.substring(0,1),n.first_name=e.data.first_name,n.email=e.data.email,n.social_media="facebook",n.stayLogged="1"),a("POST",this.urlSocialUser,n,function(a){var n=new Date;n.setMonth(n.getMonth()+1),n.setDate(1),n.setHours(0),n.setMinutes(0),n.setSeconds(0),t.setItem(s.cookieName,a.token,n,"/"),t.setItem(s.cookieName,a.token,n,"/",".clicrbs.com.br"),a.user=e,o&&o(a)},function(e){var o=new CustomEvent("paywall.social.error.login",{detail:{error:!0,login:!1}});document.dispatchEvent(o)})},s.prototype.addSocialLibs=function(){-1!==this.socialList.indexOf(this.socialNames.facebook)&&"undefined"==typeof FB&&(e.fbAsyncInit=function(){FB.init({appId:"293116970716860",xfbml:!0,cookie:!0,version:"v2.5"})},function(e,o,t){var a,s=e.getElementsByTagName(o)[0];e.getElementById(t)||(a=e.createElement(o),a.id=t,a.src="//connect.facebook.net/en_US/sdk.js",s.parentNode.insertBefore(a,s))}(document,"script","facebook-jssdk"))},e.SocialLogin=s}(window);
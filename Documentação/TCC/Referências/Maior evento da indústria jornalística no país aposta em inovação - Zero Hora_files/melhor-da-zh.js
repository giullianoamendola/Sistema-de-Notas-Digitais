(function(b){var c=function(d){this.init(d)};c.prototype={init:function(d){this.options=d||{};this.$el=this.getContainer();this.currentNewsId=+location.pathname.replace(/.*-([0-9]+)\.html.*/,"$1");this.typeCache={};this.configTemplate();this.getJson()},getContainer:function(){var d=this.options.container||".melhor-da-zh";return b(d)},getTemplate:function(){return'<li class="melhor-zh-item <%=itemClass%>"><% if (image) {%><a class="melhor-zh-item-link" href="<%=link%>"><img class="melhor-zh-image" src="<%=image%>?w=<%=imageWidth%>"></a><% }  %><h3 class="melhor-zh-title lato_bold"><a class="melhor-zh-item-link" href="<%=link%>"><%=tag%></a></h3><span class="melhor-zh-sample montserrat_bold"><a class="melhor-zh-item-link" href="<%=link%>"><%=title%></a></span></li>'},getType:function(d){if(this.typeCache[d]===undefined){this.typeCache[d]=Object.prototype.toString.call(d).replace(/\[object ([^\]]+)\]/,"$1")}return this.typeCache[d]},isObject:function(d){return this.getType(d)=="Object"},configTemplate:function(){this.template=this.getTemplate()||"";this._template=_.template(this.template)},getJson:function(){var e=this,d=this.options||{};b.ajax({url:this.options.url||"/it/json/melhor-zh.json",dataType:"json",success:function(f){e.populate(f)},error:function(f){console.log("error",f)}})},populate:function(d){if(d&&d.cards){this.populateCards(d.cards)}else{this.onDataFormatError()}},populateCards:function(j){var f,h=0,g="",e={},d=j.length||0;for(f=0;f<d;f++){if(this.validateItem(j[f])){e=this.parseItemData(j[f],d,f,h);g+=this._template(e);h++}}this.render(g)},parseItemData:function(d,f,e,i){var g={},h=d.payload||{};g.itemClass=this.getItemClass(d,f,e,i);g.tag=d.tag||"";g.image=d.image||false;g.imageWidth=this.getImageWidth(i);g.title=h.title||"";g.sample=d.title||"";g.link=d.link||"#";return g},getItemClass:function(d,f,e,g){var h="";if(g===0){h+=" primeira "}if(e===f-1){h+=" ultima "}if(d.image){h+=" has-image "}else{h+=" no-image "}return h},getImageWidth:function(d){return d===0?300:130},render:function(d){if(d.length>0){this.$el.find(".lista-melhor-zh").html(d);this.$el.animate({opacity:"1"},1500)}},validateItem:function(d){if(!this.isObject(d)||!this.isObject(d.payload)||d.payload.id==this.currentNewsId){return false}return true},onDataFormatError:function(){console.log("erro")}};var a=new c({})})(jQuery);